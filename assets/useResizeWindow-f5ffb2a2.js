import{R as v,H as g,r as l,u as _,q as I,w as T,G as w,h as P,f as b,o as R,n as L,e as M,v as j,z as U,I as W,j as S}from"./index-b48e6dac.js";function G(i,a){if(i==null)return{};var r={},s=Object.keys(i),e,t;for(t=0;t<s.length;t++)e=s[t],!(a.indexOf(e)>=0)&&(r[e]=i[e]);return r}function O(i,a){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,e){return s.__proto__=e,s},O(i,a)}function A(i,a){i.prototype=Object.create(a.prototype),i.prototype.constructor=i,O(i,a)}const C={disabled:!1},k=v.createContext(null);var H=function(a){return a.scrollTop},m="unmounted",p="exited",h="entering",x="entered",N="exiting",d=function(i){A(a,i);function a(s,e){var t;t=i.call(this,s,e)||this;var n=e,o=n&&!n.isMounting?s.enter:s.appear,u;return t.appearStatus=null,s.in?o?(u=p,t.appearStatus=h):u=x:s.unmountOnExit||s.mountOnEnter?u=m:u=p,t.state={status:u},t.nextCallback=null,t}a.getDerivedStateFromProps=function(e,t){var n=e.in;return n&&t.status===m?{status:p}:null};var r=a.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==h&&n!==x&&(t=h):(n===h||n===x)&&(t=N)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e=this.props.timeout,t,n,o;return t=n=o=e,e!=null&&typeof e!="number"&&(t=e.exit,n=e.enter,o=e.appear!==void 0?e.appear:n),{exit:t,enter:n,appear:o}},r.updateStatus=function(e,t){if(e===void 0&&(e=!1),t!==null)if(this.cancelNextCallback(),t===h){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:g.findDOMNode(this);n&&H(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===p&&this.setState({status:m})},r.performEnter=function(e){var t=this,n=this.props.enter,o=this.context?this.context.isMounting:e,u=this.props.nodeRef?[o]:[g.findDOMNode(this),o],c=u[0],f=u[1],y=this.getTimeouts(),D=o?y.appear:y.enter;if(!e&&!n||C.disabled){this.safeSetState({status:x},function(){t.props.onEntered(c)});return}this.props.onEnter(c,f),this.safeSetState({status:h},function(){t.props.onEntering(c,f),t.onTransitionEnd(D,function(){t.safeSetState({status:x},function(){t.props.onEntered(c,f)})})})},r.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),o=this.props.nodeRef?void 0:g.findDOMNode(this);if(!t||C.disabled){this.safeSetState({status:p},function(){e.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:N},function(){e.props.onExiting(o),e.onTransitionEnd(n.exit,function(){e.safeSetState({status:p},function(){e.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(o){n&&(n=!1,t.nextCallback=null,e(o))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:g.findDOMNode(this),o=e==null&&!this.props.addEndListener;if(!n||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],c=u[0],f=u[1];this.props.addEndListener(c,f)}e!=null&&setTimeout(this.nextCallback,e)},r.render=function(){var e=this.state.status;if(e===m)return null;var t=this.props,n=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var o=G(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return v.createElement(k.Provider,{value:null},typeof n=="function"?n(e,o):v.cloneElement(v.Children.only(n),o))},a}(v.Component);d.contextType=k;d.propTypes={};function E(){}d.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:E,onEntering:E,onEntered:E,onExit:E,onExiting:E,onExited:E};d.UNMOUNTED=m;d.EXITED=p;d.ENTERING=h;d.ENTERED=x;d.EXITING=N;const X=d,$=(i,a=!0)=>{const[r,s]=l.useState(0),e=l.useRef([]),{uid:t}=_(n=>n.currentUser);return l.useEffect(()=>(r===0&&(e.current=[]),()=>{e.current.length>0&&(e.current=[])}),[r]),l.useEffect(()=>{const n=I(P(b,`chats/${i[0]}/messages`),w("senderUserID"),w("date","asc"),T("isRead","==",!1),T("senderUserID","!=",t)),o=R(n,u=>{u.docs&&(s(u.docs.length),a&&u.docs.forEach(c=>{c.data().isShowNotification&&i[0]&&L(M(b,"chats",i[0],"messages",`${c.id}`),{isShowNotification:!1}).then(()=>{if(e.current.includes(c.id))return;e.current.push(c.id),new Notification("new Message",{body:c.data().message});const f=document.getElementById("notify");f&&f.play()})}))});return()=>{o()}},[i,a,t]),r},z="/react-web-messenger/assets/sprite-dfea98b3.svg",B=i=>{const[a,r]=l.useState(null);return l.useEffect(()=>{if(!i)return;const s=j(U,"status/"+i),e=W(s,t=>{if(t.exists()){const n=t.val();r(n)}else r(!1)});return()=>{e()}},[i]),a},V=({photoURL:i,displayName:a,size:r})=>(console.log("AVATAR"),i&&a?S.jsx("img",{className:"rounded-full shadow-secondaryShadow transition-all duration-150 group-hover:scale-105",width:r,height:r,src:i,alt:a}):S.jsx("div",{className:"rounded-full shadow-secondaryShadow transition-all duration-150 group-hover:scale-105",style:{width:r,height:r},children:S.jsx("p",{className:"bg-gray-300",children:"displayName"})})),q=i=>{const[a,r]=l.useState(null);return l.useEffect(()=>{if(!i)return;const s=R(M(b,"users",i),e=>{const t=e.data();t&&r(t)});return()=>{s()}},[i]),a},K=()=>{const[i,a]=l.useState(()=>window.innerWidth>640),[r,s]=l.useState(()=>window.innerHeight);return l.useEffect(()=>{const e=()=>{window.innerWidth<=640?a(!1):a(!0),s(window.innerHeight)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[a]),{isFullScreen:i,heightWindow:r}};export{V as A,X as T,G as _,B as a,q as b,K as c,z as s,$ as u};
